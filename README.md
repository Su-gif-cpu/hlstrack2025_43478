本项目基于 Vitis HLS 2024.2 对 AMD 官方 Vitis Library L1 算法模块进行体系化优化。项目共包含三个典型算法：SHA-256 哈希算法、LZ4 压缩算法和 Cholesky 分解算法。要求在保证算法功能正确性的前提下，最大化性能指标 T_exec = Estimated_Clock_Period × Cosim_Latency。
一、性能指标对比
A.SHA-256：
性能指标	优化前	优化后	改善幅度
延迟(Latency)	809cycles	752cycles	7.05%
时钟频率	77.628MHz	87.520MHz	12.74%
执行时间	10421.538 ns	8592.302 ns	17.55%
B.LZ4 Compress：
性能指标	优化前	优化后	改善幅度
延迟(Latency)	3390cycles	1605cycles	52.65%
时钟频率	75.643MHz	78.728MHz	4.08%
执行时间	44815.8ns	20386.71 ns	54.51%
C. Cholesky：
性能指标	优化前	优化后	改善幅度
初始化间隔(II)	615cycles	297cycles	51.71%
延迟(Latency)	614cycles	296cycles	51.79%
时钟频率	159.337MHz	191.755MHz	20.35%
 执行时间	30871.644 ns	12385.625 ns	59.88%

二、详细分析
A.SHA-256:
执行时间的降低主要得益于 generateMsgSchedule 模块的循环优化。原先每轮生成一个 Wt 字，展开后每次生成两个 Wt，从而使循环迭代次数减少一半，流水线的 Initiation Interval (II) 得以匹配后级 sha256Digest 的处理速率。该优化显著减少了控制逻辑等待周期，使整体执行时间下降约 17.55%。此外，函数内联与流通道深度调整也减少了上下游同步等待，提高了整体吞吐率。
    流水线效率提升：II 从 4 降至 2，使得各阶段可重叠执行。  
    延迟优化效果：Latency 从 809 cycles 降至 752 cycles。  
    吞吐率提升分析：由于消息调度与压缩部分能够并行执行，数据通路利用率显著提升。
B.LZ4 Compress:
LZ4 压缩性能提升的关键在于两点：一是提高了 dict_flush 的循环展开因子 (HLS UNROLL FACTOR)，从而加快字典初始化速度；二是引入了混合存储策略，将高频访问的热区字典 dict_hot 绑定为 LUTRAM，而将低频访问的冷区字典 dict_cold 存储在 BRAM 中。这种设计在不显著增加 LUT 使用的前提下，大幅提升了访问并行性和带宽利用率,性能提升超过 50%。
    流水线效率提升：多级 Dataflow 串联后，II 保持在 1，实现真正的全速流处理。  
    延迟优化效果：Latency 从 3390 cycles 降至 1605 cycles。  
C.Cholesky:
本题的优化属于架构级重构。通过新增 choleskySmall 实现对小规模矩阵 (≤4×4) 的全展开计算路径，完全消除循环控制开销。对大矩阵部分，则在 choleskyAlt 中引入数组分区与流水线指令，使列间计算并行。优化后，Latency 从 614 cycles 降至 296 cycles，执行时间降低约 59.88%。
    流水线效率提升：II 从 615 降至 297，确保行列计算间无等待。  
    延迟优化效果：采用对角线倒数缓存与乘法替代除法，极大减少高延迟运算。  

三、创新点总结
（1）多粒度循环展开策略：在 SHA-256 中提出“按两轮展开”的局部循环展开策略，有效平衡了性能与资源使用。  
  （2）混合存储结构设计：在 LZ4 中引入热/冷区字典分离，将部分存储放置于 LUTRAM，提高访问带宽并减小 BRAM 压力。  
  （3）结构级算法重构：在 Cholesky 中针对小矩阵场景进行完全展开计算，显著降低延迟。  
  （4）流水线与数据流解耦：通过增加 stream 通道与合理的 FIFO 深度配置，使模块间可并行执行，充分利用 HLS Dataflow 特性。  
  （5）智能编译指导：在优化过程中结合大模型建议，实现了自动化 pragma 调优与资源分配平衡，是本项目的重要创新点。

四、结论与展望
本项目针对 SHA-256、LZ4 Compress 与 Cholesky 三个算法，采用了多层次的 HLS 优化策略，显著提升了系统性能。  
    - 在 SHA-256 中，通过消息调度循环展开实现了 17.5% 的执行时间下降；  
    - 在 LZ4 Compress 中，通过混合存储策略和字典初始化展开，性能提升超过 50%；  
    - 在 Cholesky 中，通过代码重构与完全展开，使执行时间降低近 60%。  
    这些优化充分验证了高层次综合 (HLS) 在算法结构级优化中的潜力，也展示了大模型 (LLM) 在辅助硬件设计与自动 pragma 调优方面的应用价值。未来工作可在以下方向展开：  
    1. 进一步探索自动设计空间搜索 (Design Space Exploration, DSE) 与 LLM 联合优化框架；  
    2. 在更高维数据集与复杂算子中测试通用性与鲁棒性；  
    3. 探索在 FPGA SoC 平台上进行多核并行加速与异构任务调度。
    本项目最终实现的三类算法均通过了 C Simulation 与 Co-simulation 验证，结果正确、性能稳定，为后续算法级 IP 优化提供了可行范例。
